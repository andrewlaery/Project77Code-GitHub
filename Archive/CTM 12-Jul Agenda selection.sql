DROP TABLE IF EXISTS TTX_TMI_ROLES_MEMBER_RANKED0;
CREATE TABLE TTX_TMI_ROLES_MEMBER_RANKED0 (id SERIAL , NameFull VARCHAR(255) , Role VARCHAR(255) , Date1Num INT DEFAULT 1, RankAdder INT DEFAULT 1, Rank INT);
INSERT INTO TTX_TMI_ROLES_MEMBER_RANKED0 (NameFull , Role , Date1Num , RankAdder , Rank)
    SELECT 
        V_CONTESTABLE_TMIROLES_TO_MEMBERS2.NameFull ,
        V_CONTESTABLE_TMIROLES_TO_MEMBERS2.Role ,
        IFNULL(CAST(V_MOSTRECENTROLE2.Date1 AS unsigned),1) ,
        IFNULL(V_TTX_FORECAST_COUNT.RankAdder,1) ,
       (IFNULL(CAST(V_MOSTRECENTROLE2.Date1 AS unsigned),1) + IFNULL(V_TTX_FORECAST_COUNT.RankAdder,1))
    FROM V_CONTESTABLE_TMIROLES_TO_MEMBERS2
    LEFT JOIN V_MOSTRECENTROLE2 ON V_MOSTRECENTROLE2.NameFull_Role = V_CONTESTABLE_TMIROLES_TO_MEMBERS2.NameFull_Role
    LEFT JOIN V_TTX_FORECAST_COUNT ON V_TTX_FORECAST_COUNT.NameFull = V_CONTESTABLE_TMIROLES_TO_MEMBERS2.NameFull;
SELECT * FROM TTX_TMI_ROLES_MEMBER_RANKED0 GROUP BY NameFull , Role ORDER BY Role , Rank, NameFull;

TRUNCATE TABLE TTX_FORECAST0;
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Charmaine Foo' , 'Speaker');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Rajiv Goyal' , 'Speaker');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Michael Brennan' , 'Speaker');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Laura Ryan' , 'Speech Evaluator');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Lloyd Davidson' , 'Speech Evaluator');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Marcia Cameron' , 'Speech Evaluator');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Sienna Lau' , 'Speech Evaluator');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Yen Yap' , 'Speech Evaluator');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Juliana Jamal' , 'Toastmaster');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Brendan McGovern' , 'Toastmaster');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Mary Jamieson' , 'Table Topics Master');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Mohamad El-Ali' , 'General Evaluator');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Suyog Belbase' , 'Grammarian');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Walburg Steinhauer' , 'Ah-Counter');
INSERT INTO TTX_FORECAST0 (NameFull , Role) VALUES ('Michelle Bruhn' , 'Timer');


DROP TABLE IF EXISTS TTX_TMI_ROLES_MEMBER_RANKED0;
CREATE TABLE TTX_TMI_ROLES_MEMBER_RANKED0 (id SERIAL , NameFull VARCHAR(255) , Role VARCHAR(255) , Date1Num INT DEFAULT 1, RankAdder INT DEFAULT 1, Rank INT);
INSERT INTO TTX_TMI_ROLES_MEMBER_RANKED0 (NameFull , Role , Date1Num , RankAdder , Rank)
    SELECT 
        V_CONTESTABLE_TMIROLES_TO_MEMBERS2.NameFull ,
        V_CONTESTABLE_TMIROLES_TO_MEMBERS2.Role ,
        IFNULL(CAST(V_MOSTRECENTROLE2.Date1 AS unsigned),1) ,
        IFNULL(V_TTX_FORECAST_COUNT.RankAdder,1) ,
       (IFNULL(CAST(V_MOSTRECENTROLE2.Date1 AS unsigned),1) + IFNULL(V_TTX_FORECAST_COUNT.RankAdder,1))
    FROM V_CONTESTABLE_TMIROLES_TO_MEMBERS2
    LEFT JOIN V_MOSTRECENTROLE2 ON V_MOSTRECENTROLE2.NameFull_Role = V_CONTESTABLE_TMIROLES_TO_MEMBERS2.NameFull_Role
    LEFT JOIN V_TTX_FORECAST_COUNT ON V_TTX_FORECAST_COUNT.NameFull = V_CONTESTABLE_TMIROLES_TO_MEMBERS2.NameFull;
-- SELECT * FROM TTX_TMI_ROLES_MEMBER_RANKED0 GROUP BY NameFull , Role ORDER BY Role , Rank, NameFull;

SELECT NameFull , Role
FROM TTX_TMI_ROLES_MEMBER_RANKED0
WHERE Role = 'General Evaluator'
ORDER BY Rank , NameFull;

SELECT * FROM TTX_FORECAST0;
